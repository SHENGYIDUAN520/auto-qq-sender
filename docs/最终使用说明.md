# QQ查寝消息发送系统使用说明

## 背景

由于网络环境限制，无法正常连接 Mirai 服务器下载组件，我们提供了一个本地模拟版本的查寝消息发送系统。

## 使用方法

### 方式一：使用批处理文件直接发送

1. 编辑 `send_message.bat` 文件，将 `TARGET_QQ` 修改为你的目标QQ号
2. 双击运行 `send_message.bat`
3. 查看模拟发送的消息内容和状态

### 方式二：使用 Python 脚本发送

```
python scripts/direct_sender.py --target 目标QQ号 --local --message "自定义消息内容"
```

如果不指定 `--message` 参数，将自动生成带有随机码的查寝消息。

### 方式三：设置定时任务（需管理员权限）

1. 编辑 `scripts/task_scheduler.ps1` 文件，修改目标QQ号
2. 以管理员身份打开 PowerShell
3. 执行命令：`cd 到项目目录 && powershell -ExecutionPolicy Bypass -File scripts/task_scheduler.ps1`
4. 查看任务计划是否创建成功：`Get-ScheduledTask -TaskName "QQ查寝消息"`

## 功能说明

1. **本地模拟模式**：仅在本地显示消息内容，不实际发送
2. **随机查寝码**：每次运行会生成随机的三位数查寝码
3. **定时执行**：设置后每天晚上 22:40 自动运行
4. **日志记录**：运行过程写入日志，便于追踪

## 实际应用场景

1. **测试环境**：在正式部署前测试消息格式和定时功能
2. **演示用途**：向用户展示系统工作流程
3. **备用方案**：当网络环境不支持直接连接 QQ 服务器时使用

## 升级到实际发送

如需实际发送消息，需要：

1. 寻找可用的第三方消息API服务
2. 修改脚本参数，添加服务器URL和认证信息：

```
python scripts/direct_sender.py --target 目标QQ号 --server https://api.example.com --token YOUR_API_TOKEN
```

## 故障排除

- **脚本无法运行**：确认已安装Python和相关依赖
- **定时任务未执行**：检查计算机是否在指定时间开机且联网
- **参数错误**：确认QQ号和消息格式是否正确

如有其他问题，请查阅 `docs/解决方案.md` 文档 