# QQ查寝消息发送系统解决方案

## 问题分析

在尝试部署基于 Mirai 的 QQ 消息发送系统时，遇到了以下问题：

1. 网络连接问题，无法下载和验证 Mirai 组件
2. SSL握手失败，可能是由于网络环境限制
3. 无法正常启动 Mirai Console
4. 无法安装 mirai-api-http 插件

## 解决方案

### 方案1: 本地模拟模式

为了保证系统可以正常运行，我们开发了一个本地模拟版本：

1. 使用 `direct_sender.py` 脚本，支持本地模拟消息发送
2. 通过 Windows 任务计划定时运行，保持原有功能
3. 不依赖 Mirai 框架，避免网络问题

#### 使用步骤：

1. 编辑 `scripts/task_scheduler.ps1` 文件，设置目标QQ号
2. 以管理员权限运行该脚本创建定时任务
3. 系统将在每天晚上 22:40 自动模拟发送查寝消息

```powershell
# 以管理员权限运行
powershell -ExecutionPolicy Bypass -File scripts/task_scheduler.ps1
```

### 方案2: 寻找稳定可用的消息服务API

如果需要实际发送消息，可以：

1. 寻找第三方消息API服务
2. 配置 `direct_sender.py` 中的服务器URL和认证令牌
3. 修改任务计划去掉 `--local` 参数，添加服务器参数

```powershell
# 修改任务计划中的参数
$action = New-ScheduledTaskAction -Execute "python" -Argument "$scriptPath --target $targetQQ --server https://api.example.com --token YOUR_API_TOKEN" -WorkingDirectory $workDir
```

### 方案3: 离线安装Mirai

如果确实需要使用 Mirai：

1. 下载离线完整包版 Mirai (mcl-installer)
2. 手动下载 mirai-api-http 插件并复制到 plugins 目录
3. 修改网络设置或使用代理服务器解决网络问题

## 后续维护

1. 定期检查任务计划的运行状态
2. 如果需要修改消息格式，编辑 `direct_sender.py` 文件
3. 记录每日执行日志，确保系统正常运行

## 联系支持

如遇问题请联系系统管理员 